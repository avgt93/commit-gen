╔════════════════════════════════════════════════════════════════════════════╗
║                    commit-gen Project Structure                             ║
╚════════════════════════════════════════════════════════════════════════════╝

commit-gen/
├─ cmd/commit-gen/
│  └─ main.go                          (262 lines)
│     ├─ CLI Commands: generate, install, uninstall, config, preview, cache
│     ├─ Color-coded output with fatih/color
│     ├─ Cobra framework for CLI
│     └─ Configuration initialization
│
├─ internal/
│  │
│  ├─ git/
│  │  └─ diff.go                       (120 lines)
│  │     ├─ GetStagedDiff()            - Get staged changes
│  │     ├─ GetRepositoryRoot()        - Get repo root path
│  │     ├─ GetRepositoryName()        - Get repo name
│  │     ├─ ReadCommitMessage()        - Read current message
│  │     ├─ WriteCommitMessage()       - Write to commit file
│  │     ├─ GetChangedFiles()          - List changed files
│  │     ├─ IsGitRepository()          - Check if git repo
│  │     └─ HasStagedChanges()         - Check for staged changes
│  │
│  ├─ opencode/
│  │  └─ client.go                     (179 lines)
│  │     ├─ NewClient()                - Create HTTP client
│  │     ├─ CheckHealth()              - Check server status
│  │     ├─ CreateSession()            - Create new session
│  │     ├─ SendMessage()              - Send message to OpenCode
│  │     ├─ GetSession()               - Get session details
│  │     └─ Types: Client, Session, Message, PromptRequest
│  │
│  ├─ config/
│  │  └─ config.go                     (104 lines)
│  │     ├─ Initialize()               - Setup Viper config
│  │     ├─ Get()                      - Get config instance
│  │     ├─ GetString/Int/Bool()       - Accessors
│  │     ├─ Set()                      - Set config value
│  │     ├─ SaveConfig()               - Write config to file
│  │     └─ Viper with env var support
│  │
│  ├─ cache/
│  │  └─ session_cache.go              (174 lines)
│  │     ├─ GetCache()                 - Singleton instance
│  │     ├─ Get()                      - Get cached session
│  │     ├─ Set()                      - Cache a session
│  │     ├─ UpdateLastUsed()           - Update timestamp
│  │     ├─ Clear()                    - Clear all cache
│  │     ├─ Status()                   - Get cache statistics
│  │     └─ Persistent storage: ~/.cache/commit-gen/sessions.json
│  │
│  ├─ generator/
│  │  └─ commit.go                     (161 lines)
│  │     ├─ NewGenerator()             - Create generator
│  │     ├─ Generate()                 - Main generation logic
│  │     ├─ buildPrompt()              - Construct AI prompt
│  │     ├─ getStyleGuide()            - Style-specific prompts
│  │     ├─ extractCommitMessage()     - Parse AI response
│  │     └─ Supports: conventional, imperative, detailed
│  │
│  └─ hook/
│     └─ install.go                    (125 lines)
│        ├─ Install()                  - Install git hook
│        ├─ Uninstall()                - Remove git hook
│        ├─ IsInstalled()              - Check installation
│        └─ Hook script: prepare-commit-msg bash script
│
├─ Documentation/
│  ├─ README.md                        (User guide)
│  ├─ AGENTS.md                        (Architecture)
│  ├─ GETTING_STARTED.md               (Quick start)
│  ├─ PROJECT_SUMMARY.md               (Overview)
│  └─ STRUCTURE.txt                    (This file)
│
├─ Configuration/
│  ├─ go.mod                           (Go module definition)
│  ├─ go.sum                           (Dependency checksums)
│  ├─ Makefile                         (Build automation)
│  └─ .gitignore                       (Git ignore patterns)
│
└─ Artifacts/
   ├─ commit-gen                       (Compiled binary - 11MB)
   └─ .git/                            (Optional for development)

═══════════════════════════════════════════════════════════════════════════════

EXECUTION FLOW:

    User: git commit -m ""
          ↓
    Git Hook: prepare-commit-msg
          ↓
    commit-gen generate --hook
          ↓
    ┌─ config.Initialize()
    ├─ git.HasStagedChanges() ────→ Exit if no changes
    │
    ├─ opencode.CheckHealth() ────→ Prompt if not running
    │
    ├─ cache.Get() ────────────────→ Reuse session if exists
    │  └─ If not cached:
    │     └─ opencode.CreateSession() → cache.Set()
    │
    ├─ git.GetStagedDiff()
    │
    ├─ generator.Generate()
    │  ├─ generator.buildPrompt()
    │  ├─ opencode.SendMessage()
    │  ├─ generator.extractCommitMessage()
    │  └─ cache.UpdateLastUsed()
    │
    ├─ git.WriteCommitMessage()
    │
    └─ Success! Git uses the generated message

═══════════════════════════════════════════════════════════════════════════════

KEY STATISTICS:

Total Lines of Go Code:        1,125 lines
├─ main.go:                      262 lines (CLI & commands)
├─ client.go:                    179 lines (OpenCode HTTP)
├─ session_cache.go:             174 lines (Caching logic)
├─ commit.go:                    161 lines (Generation logic)
├─ diff.go:                      120 lines (Git operations)
├─ install.go:                   125 lines (Hook management)
└─ config.go:                    104 lines (Config management)

Binary Size:                   11 MB (standalone, no dependencies)

Dependencies:
├─ github.com/spf13/cobra          (CLI framework)
├─ github.com/spf13/viper          (Configuration)
└─ github.com/fatih/color          (Colored output)

Commands:
├─ generate                    (Generate commit message)
├─ install                     (Install git hook)
├─ uninstall                   (Remove git hook)
├─ config                      (Show configuration)
├─ preview                     (Preview changes & message)
├─ cache status                (Show cache statistics)
├─ cache clear                 (Clear all cached sessions)
└─ version                     (Show version)

═══════════════════════════════════════════════════════════════════════════════

CONFIGURATION OPTIONS:

opencode:
  host: localhost
  port: 4096
  timeout: 30

generation:
  style: conventional     # conventional | imperative | detailed
  model:
    provider: anthropic
    model_id: claude-3-5-sonnet-20241022

cache:
  enabled: true
  ttl: 24h
  location: ~/.cache/commit-gen

git:
  staged_only: true

═══════════════════════════════════════════════════════════════════════════════

BUILD & INSTALLATION:

Build:
  $ go build -o commit-gen ./cmd/commit-gen

Run:
  $ ./commit-gen --help
  $ ./commit-gen generate
  $ ./commit-gen install

Install to PATH:
  $ make install

Clean:
  $ make clean

═══════════════════════════════════════════════════════════════════════════════
